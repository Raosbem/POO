{% extends "layout.html" %}

{% block title %}Editar Perfil{% endblock %}

{% block content %}
<h2>Editar Perfil</h2>
<div class="card">
    <div class="card-body">
        <form method="POST" enctype="multipart/form-data">
            <!-- Datos personales -->
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" name="nombre" value="{{ candidato.nombre or '' }}" required>
            </div>
            <div class="mb-3">
                <label for="apellido_paterno" class="form-label">Apellido Paterno</label>
                <input type="text" class="form-control" id="apellido_paterno" name="apellido_paterno" value="{{ candidato.apellido_paterno or '' }}" required>
            </div>
            <div class="mb-3">
                <label for="apellido_materno" class="form-label">Apellido Materno</label>
                <input type="text" class="form-control" id="apellido_materno" name="apellido_materno" value="{{ candidato.apellido_materno or '' }}" required>
            </div>
            <div class="mb-3">
                <label for="telefono" class="form-label">Teléfono Móvil</label>
                <input type="text" class="form-control" id="telefono" name="telefono" value="{{ candidato.telefono or '' }}">
            </div>

            <!-- Info adicional -->
            <div class="mb-3">
                <label for="estado_civil" class="form-label">Estado Civil</label>
                <input type="text" class="form-control" id="estado_civil" name="estado_civil" value="{{ candidato.estado_civil or '' }}">
            </div>
            <div class="mb-3">
                <label for="sexo" class="form-label">Sexo</label>
                <select class="form-control" id="sexo" name="sexo">
                    <option value="Masculino" {% if candidato.sexo == 'Masculino' %}selected{% endif %}>Masculino</option>
                    <option value="Femenino" {% if candidato.sexo == 'Femenino' %}selected{% endif %}>Femenino</option>
                    <option value="Otro" {% if candidato.sexo == 'Otro' %}selected{% endif %}>Otro</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="fecha_nacimiento" class="form-label">Fecha de Nacimiento</label>
                <input type="date" class="form-control" id="fecha_nacimiento" name="fecha_nacimiento" value="{{ candidato.fecha_nacimiento or '' }}">
            </div>
            <div class="mb-3">
                <label for="nacionalidad" class="form-label">Nacionalidad</label>
                <input type="text" class="form-control" id="nacionalidad" name="nacionalidad" value="{{ candidato.nacionalidad or '' }}">
            </div>
            <div class="mb-3">
                <label for="rfc" class="form-label">RFC</label>
                <input type="text" class="form-control" id="rfc" name="rfc" value="{{ candidato.rfc or '' }}">
            </div>
            <div class="mb-3">
                <label for="direccion" class="form-label">Dirección</label>
                <input type="text" class="form-control" id="direccion" name="direccion" value="{{ candidato.direccion or '' }}">
            </div>

            <!-- Disponibilidad -->
            <div class="mb-3">
                <label class="form-label">Disponibilidad</label><br>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="disponibilidad_reubicacion" name="disponibilidad_reubicacion" {% if candidato.disponibilidad_reubicacion == 1 %}checked{% endif %}>
                    <label class="form-check-label" for="disponibilidad_reubicacion">Reubicación</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="disponibilidad_viajar" name="disponibilidad_viajar" {% if candidato.disponibilidad_viajar == 1 %}checked{% endif %}>
                    <label class="form-check-label" for="disponibilidad_viajar">Viajar</label>
                </div>
            </div>
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="licencia_conducir" name="licencia_conducir" {% if candidato.licencia_conducir == 1 %}checked{% endif %}>
                    <label class="form-check-label" for="licencia_conducir">¿Cuenta con licencia de conducir?</label>
                </div>
            </div>

            <!-- Modalidad y puesto -->
            <div class="mb-3">
                <label for="modalidad" class="form-label">Modalidad</label>
                <select class="form-control" id="modalidad" name="modalidad">
                    <option value="Presencial" {% if candidato.modalidad == 'Presencial' %}selected{% endif %}>Presencial</option>
                    <option value="Remoto" {% if candidato.modalidad == 'Remoto' %}selected{% endif %}>Remoto</option>
                    <option value="Híbrido" {% if candidato.modalidad == 'Híbrido' %}selected{% endif %}>Híbrido</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="puesto_actual" class="form-label">Puesto Actual</label>
                <input type="text" class="form-control" id="puesto_actual" name="puesto_actual" value="{{ candidato.puesto_actual or '' }}">
            </div>

            <!-- Documentos -->
            <div class="mb-3">
                <label for="foto_perfil" class="form-label">Foto de Perfil</label>
                <input type="file" class="form-control" id="foto_perfil" name="foto_perfil" accept="image/*">
                {% if candidato.foto_perfil %}
                    <img src="{{ url_for('static', filename=candidato.foto_perfil.split('static/')[-1]) }}" alt="Foto" class="mt-2" style="max-height: 100px;">
                {% endif %}
            </div>
            <div class="mb-3">
                <label for="cv_pdf" class="form-label">Cargar CV (PDF)</label>
                <input type="file" class="form-control" id="cv_pdf" name="cv_pdf" accept=".pdf">
                {% if candidato.cv_pdf %}
                    <a href="{{ url_for('static', filename=candidato.cv_pdf.split('static/')[-1]) }}" target="_blank">Ver CV actual</a>
                {% endif %}
            </div>

            <!-- Resumen -->
            <div class="mb-3">
                <label for="resumen" class="form-label">Resumen</label>
                <textarea class="form-control" id="resumen" name="resumen" rows="4">{{ candidato.resumen or '' }}</textarea>
            </div>

            <!-- Nuevos apartados -->
            <!-- Preparación Académica -->
            <h4>Preparación Académica</h4>
            <div class="mb-3">
                <label for="grado_estudios" class="form-label">Grado/Nivel de estudios</label>
                <input type="text" class="form-control" id="grado_estudios" name="grado_estudios" value="{{ candidato.grado_estudios or '' }}">
            </div>
            <div class="mb-3">
                <label for="cedula_profesional" class="form-label">Cédula Profesional</label>
                <input type="text" class="form-control" id="cedula_profesional" name="cedula_profesional" value="{{ candidato.cedula_profesional or '' }}">
            </div>
            <div class="mb-3">
                <label for="estatus_academico" class="form-label">Estatus Académico</label>
                <select class="form-control" id="estatus_academico" name="estatus_academico">
                    <option value="en_proceso" {% if candidato.estatus_academico == 'en_proceso' %}selected{% endif %}>En Proceso</option>
                    <option value="trunca" {% if candidato.estatus_academico == 'trunca' %}selected{% endif %}>Trunca</option>
                    <option value="finalizada" {% if candidato.estatus_academico == 'finalizada' %}selected{% endif %}>Finalizada</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="institucion" class="form-label">Nombre de la Institución</label>
                <input type="text" class="form-control" id="institucion" name="institucion" value="{{ candidato.institucion or '' }}">
            </div>
            <div class="mb-3">
                <label for="pais_academico" class="form-label">País</label>
                <input type="text" class="form-control" id="pais_academico" name="pais_academico" value="{{ candidato.pais_academico or '' }}">
            </div>
            <div class="mb-3">
                <label for="fecha_inicio" class="form-label">Fecha de Inicio</label>
                <input type="date" class="form-control" id="fecha_inicio" name="fecha_inicio" value="{{ candidato.fecha_inicio or '' }}">
            </div>
            <div class="mb-3">
                <label for="fecha_fin" class="form-label">Fecha de Fin</label>
                <input type="date" class="form-control" id="fecha_fin" name="fecha_fin" value="{{ candidato.fecha_fin or '' }}">
            </div>

            <!-- Experiencia Laboral -->
            <h4>Experiencia Laboral</h4>
            <div class="mb-3">
                <label for="empresa" class="form-label">Nombre de la Empresa</label>
                <input type="text" class="form-control" id="empresa" name="empresa" value="{{ candidato.empresa or '' }}">
            </div>
            <div class="mb-3">
                <label for="domicilio_empresa" class="form-label">Domicilio de la Empresa</label>
                <input type="text" class="form-control" id="domicilio_empresa" name="domicilio_empresa" value="{{ candidato.domicilio_empresa or '' }}">
            </div>
            <div class="mb-3">
                <label for="telefono_empresa" class="form-label">Teléfono de la Empresa</label>
                <input type="text" class="form-control" id="telefono_empresa" name="telefono_empresa" value="{{ candidato.telefono_empresa or '' }}">
            </div>
            <div class="mb-3">
                <label for="telefono_jefe" class="form-label">Teléfono Jefe Inmediato</label>
                <input type="text" class="form-control" id="telefono_jefe" name="telefono_jefe" value="{{ candidato.telefono_jefe or '' }}">
            </div>
            <div class="mb-3">
                <label for="puesto_jefe" class="form-label">Puesto Jefe Inmediato</label>
                <input type="text" class="form-control" id="puesto_jefe" name="puesto_jefe" value="{{ candidato.puesto_jefe or '' }}">
            </div>
            <div class="mb-3">
                <label for="fecha_ingreso" class="form-label">Fecha de Ingreso</label>
                <input type="date" class="form-control" id="fecha_ingreso" name="fecha_ingreso" value="{{ candidato.fecha_ingreso or '' }}">
            </div>
            <div class="mb-3">
                <label for="fecha_salida" class="form-label">Fecha de Salida</label>
                <input type="date" class="form-control" id="fecha_salida" name="fecha_salida" value="{{ candidato.fecha_salida or '' }}">
            </div>
            <div class="mb-3">
                <label for="puesto" class="form-label">Puesto Desempeñado</label>
                <input type="text" class="form-control" id="puesto" name="puesto" value="{{ candidato.puesto or '' }}">
            </div>
            <div class="mb-3">
                <label for="funciones" class="form-label">Funciones Desempeñadas</label>
                <textarea class="form-control" id="funciones" name="funciones" rows="4">{{ candidato.funciones or '' }}</textarea>
            </div>
            <div class="mb-3">
                <label for="sueldo_inicial" class="form-label">Sueldo Bruto Inicial</label>
                <input type="text" class="form-control" id="sueldo_inicial" name="sueldo_inicial" value="{{ candidato.sueldo_inicial or '' }}">
            </div>
            <div class="mb-3">
                <label for="sueldo_final" class="form-label">Sueldo Bruto Final</label>
                <input type="text" class="form-control" id="sueldo_final" name="sueldo_final" value="{{ candidato.sueldo_final or '' }}">
            </div>
            <div class="mb-3">
                <label for="motivo_salida" class="form-label">Motivo de Separación</label>
                <input type="text" class="form-control" id="motivo_salida" name="motivo_salida" value="{{ candidato.motivo_salida or '' }}">
            </div>

            <!-- Referencias -->
            <h4>Referencias</h4>
            <div class="mb-3">
                <label for="nombre_referencia" class="form-label">Nombre Completo</label>
                <input type="text" class="form-control" id="nombre_referencia" name="nombre_referencia" value="{{ candidato.nombre_referencia or '' }}">
            </div>
            <div class="mb-3">
                <label for="ocupacion_referencia" class="form-label">Ocupación</label>
                <input type="text" class="form-control" id="ocupacion_referencia" name="ocupacion_referencia" value="{{ candidato.ocupacion_referencia or '' }}">
            </div>
            <div class="mb-3">
                <label for="telefono_referencia" class="form-label">Teléfono</label>
                <input type="text" class="form-control" id="telefono_referencia" name="telefono_referencia" value="{{ candidato.telefono_referencia or '' }}">
            </div>
            <div class="mb-3">
                <label for="anios_conocido" class="form-label">Años de Conocerlo</label>
                <input type="text" class="form-control" id="anios_conocido" name="anios_conocido" value="{{ candidato.anios_conocido or '' }}">
            </div>
            <div class="mb-3">
                <label for="empresa_referencia" class="form-label">Empresa en la que Trabaja</label>
                <input type="text" class="form-control" id="empresa_referencia" name="empresa_referencia" value="{{ candidato.empresa_referencia or '' }}">
            </div>
            <div class="mb-3">
                <label for="doc_pdf_referencia" class="form-label">Documento PDF de Referencia</label>
                <input type="file" class="form-control" id="doc_pdf_referencia" name="doc_pdf_referencia" accept=".pdf">
            </div>

            <!-- Habilidades -->
            <h4>Habilidades y Competencias</h4>
            <div class="mb-3">
                <label for="habilidades" class="form-label">Habilidades</label>
                <input type="text" class="form-control" id="habilidades" name="habilidades">
                    {% for habilidad in habilidades %}
                        <option value="{{ habilidad.id }}" {% if habilidad.id in candidato.habilidades %}selected{% endif %}>{{ habilidad.nombre }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <label for="competencias" class="form-label">Competencias Organizacionales</label>
                <input type = "text" class="form-control" id="competencias" name="competencias">
                    {% for competencia in competencias %}
                        <option value="{{ competencia.id }}" {% if competencia.id in candidato.competencias %}selected{% endif %}>{{ competencia.nombre }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </form>
    </div>
</div>
{% endblock %}
